---
title: 1권 3장 - 신경망
publishedAt: 2023-06-30
description: 밑바닥부터 시작하는 딥러닝 Chapter 3 정리
keywords: [AI]
series: 밑바닥부터 시작하는 딥러닝
---

## 신경망이란?

이미지 출처: [위키백과](https://ko.wikipedia.org/wiki/%EC%9D%B8%EA%B3%B5_%EC%8B%A0%EA%B2%BD%EB%A7%9D)
![](data:image/png;base64,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)

신경망은 입력층, 은닉층, 출력층으로 이루어져 있다.
각각의 노드에서 다음 노드로 갈 때의 과정은 다음과 같다.

1. 두 노드에 각각 가중치(w1, w2)를 곱하고 편향(b)을 더한다.
2. 위에서 나온 값에 활성화 함수를 적용시켜서 최종적인 값을 출력한다.

활성화 함수라는 새로운 개념이 등장했다.

<br />

## 활성화 함수

입력 신호의 총합을 출력 신호로 변환하는 함수를 활성화 함수라고 한다.
이름이 말해주듯 활성화 함수는 입력 신호의 총합이 활성화를 일으키는지를 정하는 역할을 한다.

앞에서 배웠던 단순한 퍼셉트론은 출력이 0 아니면 1로만 이루어졌다.
계단 함수(step function)가 바로 이것과 같은 함수인데, 퍼셉트론은 계단 함수를 활성화 함수로 사용하는 신경망이라고 볼 수 있다.

## 활성화 함수의 종류

### 계단 함수

- 입력이 0을 넘으면 1을 출력하고, 그 외에는 0을 출력하는 함수
- 그래프가 계단처럼 생겼기 때문에 이러한 이름이 붙여졌다.

<br />
**그래프** ![](data:image/png;base64,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)

<br />
**코드**

```python
def step(x):
    if x > 0:
        return 1
    else:
        return 0
```

<br />
numpy 배열도 지원하기 위해 함수를 다음과 같이 변경했다.

```python
def step(x):
    return np.array(x > 0, dtype=int)
```

<br />

### 시그모이드 함수

- 신경망에서 자주 이용하는 활성화 함수
- 계단 함수와 다르게 0과 1 사이의 중간값이 부드럽게 연결되어 있다.

<br />
**그래프** ![](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAARUAAAC2CAMAAADAz+kkAAABO1BMVEX////S0tK6urqKioqYmJjg4OBgYGCOjo5/f3/c3Nz8/Pzs7Ozy8vL4+Pj29vbo6OhlZWXPz8/09P/s7P/w8P+rq6uTk5PIyMgAAAChoaG/v797e3v5+f9oaP9xcf/o6P9sbP9ubm7c3P/Q0P+fn/+oqP+Jif/Ly/+3t/+np6e0tLRVVVW+vv92dv+Zmf9MTEyRkf9YWP/Y2P9jY/9PT/+trf9FRf8wMDC4w859ff9dXf83N/+8vP/Gxv9xZ105OTnl5dnh4erExN29veK9vfBbW/JmZvB8fPI9Pf98d28mKjEFDBqUjYQAECNyeIGIkp3i29M9Q0xaUkuss7xMPCu7r6NVYXGYoazJwLdGPzp4foQkFwM4Kx+kpI51dY4AAI5HR4+WltUsLNyHh9x7e+ZycuRgYNdLS9PS0uamhqW5AAAL00lEQVR4nO2dCXvaOBrHZcCAZdnmCDjmNgFCIOQgJG3SpkkznbTdyXbTzuwc3XN22t1+/0+wks1lsBXHiQ2O9c/zOOGVXr3iF1k+EK8BYGJiYmJiYgqLhBhNJc+FDyn1r2HZJZV+OuGslE4pTOhxWmmGVhjv00rLtIaLSWrDtB5rF5xLKkmeUohiNFdVoZUWIKWQL1IbFimF0g7NVaH2OP04VFSaK0elUpIohUKK2jCVCvV9i1la6eNQ8U10Kr6JUbETo2InRsVOjIqdGBU70akoxjEVCZBRmQmVn5FfyXicUZkT3MebbBHoiFGZSb7Am1gClBWQLJRUgHggyFAAPAICUES8EXnA4V0MCJLEETMHRAVwUCYVJVIRGhU5oyIkFhm/IBaILYJEXMcVTVdAXCUzBgeyKSAYFeEkhtkYrihhL4E0z5N+KIoZQ4AyiQHHMZDRGA8uJXAJLmUgVF5/qz9vDq+2rra3r86/e7N79fLNm+6VWdFwlQROTVKpiBdAEpWyrEOQzIoigDJAECAgGxsJbyRsARBhMxybJYm8kBcs04pWV5uKlhh4rMy7QosrGleUbGNgiwxgLt9sDt909zqD76tnR43va43rwfVgcHr69m3n4GBvb6/dah+334BZPyBCqEyjAov7RT4OUplY+OaVSq7ZPTgdVA/PGp12d3t7a9is53MV2qXoTE/yyJzv7h29GHXaL4d5b2GfHJVmd/BusHdeeVDYJ0UFNltHtVZz48FhnxCVynH16GX9UcI+GSr1zrvWwwfJWE+ESrN2tP2IYZ8ElXynuvWoYQOjIrj9MMHq5YZKd7TrpW2KAqIivt/05O+CSv6s46VlqgKiovJ/8onK8WHTS8N0BbYH+UOl0unkvLR7h8JNZaPa9tSZuxRqKvmTxz30TBUUFfkHwYsblUr9nceLvzv1MCqS+Vmpcuf1+W05qVM/w3QQjUrzxI8pxZBXKjcIb8RyyXjRK3s6GXEhChUfoXimskk+M5/eyFMzj9mnOTlTqb97tKueZXmjkr35cwxvdQBQodDLAtgnuxK5t4fQow4bRyobvs0pRJ6o3Hy4Sb3/C9jBXf71s7qJm4j3sFnIEOnIqAPvkquoTlQqfpy7zeSFyu1H+P757UeQ0PCxBX36EZuKGimQDRl1uGSGrqSrY5ITldOuy257kxcqvQ/gp9xffwZaAr/49AsxpcjCottnRB+NsQLFu+RqsDhQaT3+pY9FnsbKRemH7DMelMoAvPogkM+MMsZ//h67hkvZUzkfPGYMG3maV25ffUyQ6bWvwHQijgcLf7HsIGuTptFSGaftuItrSyU38nOmJfJ2DLr50fiV1U2jYDNJ3GY2n4//vJhb+YayWEBTXd5YsKVyNnTl+wB5o6KNKYjmKkF1eTQAhGfk8Z+bYypquSgrGhaQfqOt85uTHZXjA3e+D5CP10GvDCoiz28KPIHw689g3zzrR79pOm3l5Ew2VIaH9+3I/eU7lZ1kZjOTxHMP/PT5/WdzKkalEnUp6kzLVGDV1zMVU75Twdo0tuLfhPtfdi9TabXu3cj95RsVqfT3z2MXc16Rf/rlJn6/Nmyo5EePeuR3kG9UUKG3M95NUuYbERMud5s5LVHx90x/opB9HrTr80ntWOGikjt52FoDtwoXlQN/LwqnChWVZjWgsKGiUvX9VH+sMFHZ8vtSeaowUTnx8U6tVSGisuv/VeFE4aFSOfTvk45FhYfK8V5wYUNDJRfgUAkPldZxgGHDQqUyCnCohIZKoEMlLFQqLwINGxIqwQ6VkFDZGAUbNhxU2v4sf3NUKKjkzoK52TRVKKgEPVTCQWUU2MXyWGGg0g3wCshUGKi8COIjIItCQOU8uPsqE60/lcqR36tVlrX+VIK7WzuTHRUxphWWFlKvjEoQaxAWZUOF7ymyrMYWprgVUSkOVzBU7KjIgJcVIBEq0FjpiES0Mir/OA3qM6B52c4rhVjMXKBfLOsYy0W6sDIq/2ysIqwtlZJYNNYS8xmSYwRcxFY2Vi7/tYqhYkfFWPonITxIBB0UBQDUUgaCZCzLAbxn8SSdiYIAD0QRbxDZEDM0zYJhgdK0IjQqYjOpI2GLTLK2YH9oWLCrIklGRcNVsMa4/TeJMa1IGrPEkK2dWYghQKMxwzLpzDTGtMPEdVYRx+C5zDIVcSer8L0SpqIkgS7KAAJdAckSzwNJBAqECsBGBSA02WCzSMyImGVsgcQiQbyR4biOjF0BcZUmXtOKZovQtFhj/J4Yu8LlGKR50tisM0YMaS4GNFyNipZeL70Ps3mz14rC6zZ7EMwWVHN/KfRTchn0k4kV7UG5/9ysIKr9HqSUjBX6Vq2ESvuPtaECeY1T1cX1sKugUqmuU7YrrleKLWZfXQWVbotfIyogW1oyrYLKycY6jRU7rYDK7sF65oub0wqojDYYlSWR60JGZVGNJqOypCFZRsqoLGhAMkMwKlY1G2TLqFhVM5KIMCoW1c3F6YyKRadmvhlGZV758YIVRmVenXGmQEZlTvXJt3MZlTmdTpJKMiozzb4dxajM1JgmPGNUphrWpn8yKlMdzRIaMyoTzQ0VRmUieDi3iodRGas7v+CLUTGVO5tfRsqomNqzfI+BUTG0MbIsTmdUDJ1ZV8ExKkTbp9bXjAogmeAWvl3IqGAdLH5ljFEBYKu2aGFUABgtPdGFUbHLxMOo2CUNjDyVhfM3U5GnUju3MUadSsv2a3QRp7J1ZGuONpW6Qx6ESFPJHzo8ey7KVCpVu5mWKMpUzhyfKxZhKs5QokslV6Ok3IwqlVyDlnAmolTyJ9RnWkaTyvY7+uNgo0gF7jXuSDcTQSr1szuzyEePSvvk7u/6R43K7shNWqJIUYHDasfVU7ejROW82nCZKCMyVOqtF+7GCVE0qDSPDxv3yan/5KlU8sNOo3rsepgYWksq0EAByXebH0QFNo87RycH5/fO0LSOVKRMIo1/9dNxr1TyWy/bB2cvRm/bW57Sm60jFS4N9hHIFoGOXFCBudxGvd4cbm1vn3fbncHZ6Kx62jnoDive872tIxXMI4lAKUFy0yQLqgoQDwQZCoBHnT9Ov7wdfBl8/Vr7Uht8xT+1/9aurxv/a1xfd762jn9vXn3Lc/CSZEJRRMAZrlDCrjJ+QSwk/4oAZdIiMSPIAVHBZcQiGTHwi2wK1xGJqyxgszRujFQkjQkkawtPMqooCknLMq7Iy3ASgze9eLMi3hgx0HwMkfTDsJiuAqcmaVQEHVwgyKehDkGyJJj5V8xMJltX28Ph1rdh81vzdbP+Ov86l1MAguAS73dkM61o5l/hp/lXFImkj0HTtCrKtCJvVrTkRuFS8xXH+VfMxqDZmELSzyjWFsVxDB7OKs5lW+HBpDFRHncGzlyd8q/MpO2rShyk+qVV50IOWHccmc18I2ReYFTsxKjYiVGxE6NiJ0bFToyKnRgVOzEqdqJSQcvZseakLuYTsyhGeyYxnUqW9pRnqUdzVahPL3VPhfbWUIzmSqdSoF078kVqwzQqcIfmqlD/j66p9MtxZ6WTKefCVIbmmupTCuPlfVrDeprm26e4xsvUHl+4paJwPkl4QKlvru6eNM7kIFgo2jz0fiotIVNKs5QhyRedpxYuTpk6sinq5MAtZUS3NEzpEUpQJ7t5leJq2bk0XaKNOrSvORcKXMKpVOkLGef+ZYUy5Y2jfcpMzacFyiFAVxPUA5gpSURIEpO6/ZEGYYFnesZ2JEGjNF6yf98SLsRDTHPqQ1YDfdoBrEz5h6eyy+lop0r0+5RxFiu7OTvL4rk+FtOEtF2hlMCztrgJC7ZvTcGFmpop6rb/cpU0jEehY2A6FY1y8FWTWtJ59CYKwL5HhnSuV3Bu2aJCgtOdS3Uu7XxeJAs7lJ2P2xecJg+lz1M638sIznOZLPQorlw5S+lRn9uhnuxYOqFRZj6kUWc+UXAuE3oFxx2BS1Biqr0CbfeSKTGBqlEOHUjrBf4YGiYmJiamNZOcKLo4yYyaoJJ2feIQIam2p9MRl7K5Q73LF01BpNDuXjAxrZP+D6Cw7Q3ddd9IAAAAAElFTkSuQmCC)
<br />
**코드**

```python
def sigmoid(x):
    return 1 / (1 + np.exp(-x))
```

<br />

### ReLU 함수

- 시그모이드 함수는 신경망 분야에서 오래전부터 이용해왔으나, 최근에는 ReLU 함수를 주로 이용한다.
- ReLU 함수는 입력이 0을 넘으면 그 입력을 그대로 출력하고, 0 이하이면 0을 출력한다.

<br />
**그래프** ![](data:image/png;base64,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)
<br />
**코드**

```python
def ReLU(x):
    return np.maximum(0, x)
```

<br />

## 비선형 함수

위의 함수는 모두 비선형 함수다.
출력이 입력의 상수배만큼 변하는 함수를 선형 함수라고 하고, 직선 1개로 표현된다.
하지만 위의 함수들은 직선 1개로 표현할 수는 없기 때문에 비선형 함수로 분류된다.

신경망에서는 활성화 함수로 비선형 함수를 사용해야 한다.
선형 함수를 사용하면 신경망을 여러 층으로 구성하는 이점을 살릴 수 없다.

<br />
## 출력층 설계하기

위에서 살펴본 활성화 함수는 신경망 중간에 위치한 은닉층에서 사용하는 함수들이다.
신경망의 마지막 단계인 출력층에서는 다른 함수를 사용한다.

신경망은 분류와 회귀 모두에 이용할 수 있다.
둘 중 어떤 문제냐에 따라 출력층에서 사용하는 활성화 함수가 달라진다.

일반적으로 회귀에는 항등 함수(identity function)를,
분류에는 소프트맥스 함수(softmax function)를 사용한다.

### 항등 함수

항등 함수는 입력값 그대로 출력하는 함수다.

```python
def identity(x):
    return x
```

<br />

### 소프트맥스 함수

![](data:image/png;base64,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)

소프트맥스 함수의 분자는 입력 신호의 지수 함수,
분모는 모든 입력 신호의 지수 함수의 합으로 구성된다.

하지만 만약 위의 식대로 구현한다면,
지수 함수가 아주 큰 값을 내뱉으므로 오버플로 문제가 생길 수 있다.
따라서 실제로 구현할 때는 식의 분모와 분자에 각각 x의 최댓값을 빼준 뒤 계산한다.

```python
def softmax(x):
    x = x - np.max(x)  # 오버플로 대책
    return np.exp(x) / np.sum(np.exp(x))
```

소프트맥스 함수의 출력은 항상 0에서 1 사이의 실수이고, 출력의 총합은 1이다.
이 점은 소프트맥스 함수의 중요한 성질로, 덕분에 출력을 확률로 해석할 수 있다.

다음의 예처럼 소프트맥스 함수는 각각의 입력에 대한 확률이 출력된다.

```python
x = np.array([0.3, 2.9, 4.0])
print(softmax(x))
# [ 0.01821127. 0.24519181, 0.73659691 ]
```

다만 소프트맥스 함수를 적용해도 각 원소의 대소 관계는 변하지 않는다.
신경망을 이용한 분류에서는 일반적으로 가장 큰 출력을 내는 뉴런에 해당하는 클래스로만 인식한다.
따라서 신경망으로 분류할 때는 출력층의 소프트맥스 함수는 생략해도 된다.
현업에서도 지수 함수 계산에 드는 자원 낭비를 줄이고자 출력층의 소프트맥스 함수는 생략하는 것이 일반적이다.

<br />

## 손글씨 숫자 판별하기 실습

3장에서는 이미 학습된 매개변수를 이용한 추론 과정만 구현한다.
이 추론 과정을 신경망의 **순전파**라고 한다.

### 데이터셋

![](data:image/jpeg;base64,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)
MNIST라는 손글씨 숫자 이미지 데이터를 사용한다.
데이터셋은 위처럼 0부터 9까지의 숫자 이미지로 구성되고, 각각의 이미지에 대응되는 숫자가 레이블로 제공된다.

### 실습 코드

테스트 데이터를 불러오고 미리 학습된 매개변수를 이용해서 추론하는 과정이다.
데이터를 불러오는 load_mnist 함수에서 normalize 인수를 True로 설정했다.
이렇게 하면 0~255 범위인 각 픽셀의 값을 0~1 범위로 변환한다.

이처럼 데이터를 특정 범위로 변환하는 처리를 **정규화**라 하고,
신경망의 입력 데이터에 특정 변환을 가하는 것을 **전처리**라 한다.

여기서는 입력 이미지 데이터에 대한 전처리 작업으로 정규화를 수행한 것이다.

```python
# 숫자 판별
import sys, os

sys.path.append(os.pardir)
import pickle
import numpy as np
from dataset.mnist import load_mnist
from vitalize_func import *

# 데이터셋 불러오기
def get_data():
    # (훈련 이미지, 훈련 레이블), (시험 이미지, 시험 레이블)
    (x_train, t_train), (x_test, t_test) = load_mnist(flatten=True, normalize=True)
    return x_test, t_test


# 이미 학습된 매개변수 불러오기
def init_network():
    # 현재 실행 중인 파일의 절대경로
    script_dir = os.path.dirname(os.path.abspath(__file__))
    # 파일의 경로
    file_path = os.path.join(script_dir, "sample_weight.pkl")
    with open(file_path, "rb") as f:
        network = pickle.load(f)

    return network


# 추론 과정
def predict(network, x):
    W1, W2, W3 = network["W1"], network["W2"], network["W3"]
    b1, b2, b3 = network["b1"], network["b2"], network["b3"]

    a1 = np.dot(x, W1) + b1
    z1 = sigmoid(a1)
    a2 = np.dot(z1, W2) + b2
    z2 = sigmoid(a2)
    a3 = np.dot(z2, W3) + b3
    y = softmax(a3)

    return y


x, t = get_data()
network = init_network()

accuracy_cnt = 0
for i in range(len(x)):
    y = predict(network, x[i])
    p = np.argmax(y)  # 확률이 가장 높은 원소의 인덱스
    if p == t[i]:
        accuracy_cnt += 1

print(f"정확도: {accuracy_cnt / len(x)}")
# 정확도: 0.9352
```

### 배치 처리

데이터를 입력할 때 여러 개를 한 번에 묶어서 보내면 처리 시간을 대폭 줄일 수 있다.
이때 하나로 묶은 입력 데이터를 **배치**라고 한다.

다음은 위의 과정을 배치 처리를 이용해서 구현한 코드이다.
(바뀐 부분은 아래와 같다)

```python
x, t = get_data()
network = init_network()
batch_size = 100  # 배치 크기

accuracy_cnt = 0
for i in range(0, len(x), batch_size):
    x_batch = x[i : i + batch_size]
    y_batch = predict(network, x_batch)

    p = np.argmax(y_batch, axis=1)  # 100x10 행렬의 각 행마다 확률이 가장 높은 원소의 인덱스들을 배열로 반환한다
    accuracy_cnt += np.sum(p == t[i : i + batch_size])

print(f"정확도: {accuracy_cnt / len(x)}")
# 정확도: 0.9352
```

이렇게 데이터를 배치로 처리함으로써 더 효율적이고 빠르게 처리할 수 있다.
